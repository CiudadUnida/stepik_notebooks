# 1.2. Big data, deep & machine learning, основные понятия.

Итак, давайте начинать!  

Как я уже говорил ранее, очень важной задачей нашего курса будет не только разобраться с тем, как устроено дерево решений или какие команды на python нужно выполнить, чтобы всё получилось. Но и сформировать более общее представление о том, как методы машинного обучения, да и в целом data-science, интегрированы в реальные задачи, какие при этом процессы возникают, какие data-scientist бывают, и что ещё обязательно нужно знать, чтобы успешно в этой области развиваться.
  
Ну, я думаю вы уже не раз видели эту картинку про то, что data scientist - это самая сексуальная работа 21-го века, ну и основной посыл, что помимо машинного обучения существует очень много тем, необходимых для понимания, и в которых нужно уверенно себя чувствовать. Это и программирование, и статистика, и аналитика, и работа с базами данных. И, к сожалению, всего этого многообразия мы не затронем в этом курсе.
  
Поэтому очень полезно сразу вместе с машинным обучением пытаться вникать и в те области, которые всегда идут с машинным обучением рука об руку в любых задачах, возникающих у data-scientist'а. Я постарался - довольно много подготовил дополнительных материалов на дополнительные источники, на лекции, на youtube, на другие курсы на stepik и другие материалы, позволяющие как раз поднять те вопросы, те очень важные темы, необходимые для понимания, но которые, к сожалению, не будут освещены конкретно в этом курсе.
  
Поясню свою мысль на примере.

## problem
  
Уж, очень мне нравится пример про применение машинного обучения в онлайн-играх. Люблю игры. Допустим, у нас есть игра.  

Пользователи скачивают её на мобильный телефон, создают эпического фентезийного персонажа, и отправляются в путешествие по интересному миру со всякими драконами, гоблинами и т.д.  
  
И вот одни пользователи, ну, вообще молодцы: скачивают приложение, каждый день в него играют, покупают всякие мечи за деньги дополнительные, retention(?) у них высокий, arpu(?) на юзера просто замечательный - всё круто.  

А другие пользователи скачали приложение, пару раз поиграли, удалили и больше никогда к нам не возвращались.  

Возникает вопрос: а можно ли с этим что-то сделать? Можно ли как-то повлиять на то - останется ли пользователь в нашем приложении или удалит и больше никогда не вернётся?  
  
И это первая очень понятная стадия любой задачи, в которой машинное обучение используется. Умение видеть проблему, которую нужно решить - ключевая компетенция любого data-scientist'а. Без этого никакое машинное обучение в принципе и не нужно.  

Далее, как только мы сформулировали некоторую проблему, которая сформулирована на языке продуктовой задачи - как избежать того, что пользователи перестают пользоваться приложением.  

Далее переводим её на язык машинного обучения - поняли, что это задача классификации или регрессии и для решения мы будем использовать логистическую регрессию.  

## data engineering
  
Так вот в любом случае, чтобы использовать логистическую регрессию нам нужны данные. Без данных мы никакую регрессию не применим, и если мы говорим про наш пример, понятное дело нужно логировать события пользователей внутри игры и где-то их хранить.  
  
И это отдельная огромная область знаний, которая называется data engineering, отвечающая на вопросы:
- как нам хранить данные?
- где их хранить?
- как обеспечить хранение миллиардов данных, которые могут происходить в нашем приложении
  
И это тоже очень важная компетенция любого data-scientist.
  
## maschine learning
  
Приблизительно после этого возникает время машинного обучения - когда мы сформулировали проблему, сохранили данные, теперь можно подумать о том, как нам обучить регрессию.  

Так вот, после того как мы это сделали нужно результат нашего машинного обучения как-то внедрить в продукт.
  
## programming
  
Пофантазируем - мы подумали, что тем пользователям, которым мы предсказали высокую вероятность ухода, мы покажем рекламную плашку "купи новый меч". Для этого нам нужно изменить исходный код игры, реализовать логику машинного обучения, внедрить её в наш продукт и как-то запрограммировать это всё.  
  
Всё вместе это по-прежнему не отвечает на наш вопрос. Допустим, мы это сделали и пользователи, которые видят эту плашку, покупают мечи бесплатно. Здесь интуитивно понятно, что надо проверить, а работает ли наше решение.
  
## analytics
  
Допустим, у нас есть 2 группы (экс и контрольная). Одним пользователям, которым мы предсказали высокую вероятность ухода, ничего не показывать. А другим показать плашку про бесплатный меч.  

А потом, например через недельку, посмотреть результат - а правда ли, что для тех пользователей, которым мы предсказывали уход из игры и которым мы показали плашку с рекламой, ситуация стала лучше.
  
## data science
  
Все предыдущие пункты вместе называются data science. В идеальном мире, человек, занимающийся машинным обучением и data science, может сам взяться за все стадии этой задачи.  

На практике этим занимается команда людей с понятными пересекающимися ролями. Баланс сил относит человека к какой-то одной из соответствующих областей.
  
Посмотрите это [выступление](https://www.youtube.com/watch?v=lDkTNURDIaY) про то, как всё устроено в реальности.
  
Поэтому когда мы слышим фразу "машинное обучение применили для того, чтобы что-нибудь сделать" на самом деле нужно понимать, что эта задача состоит из нескольких отдельных областей, в которых задействованы разные специалисты из data-science и в нашем курсе мы будем исследовать область обучения моделей.  

Т.е. у нас есть данные, поставлена задача, и мы хотим в этих данных, используя методы машинного обучения, найти закономерности, решить задачу классификации, регрессии.  

Какими методами это можно сделать и как - об этом в основном мы и будем говорить.
  
Если применение машинного обучения разбивается на несколько подстадий, из которых мы будем больше фокусироваться на стадии именно обучения моделей (т.е. у нас есть некоторые данные, мы их скачали, считали с помощью библиотеки pandas и теперь хотим найти закономерности в этих данных, классифицировать наши наблюдения на две категории или решить задачу регрессии). Вот как в этом нам помогут различные методы машинного обучения? Именно об этом мы и будет разговаривать в большей части нашего курса. 
Однако сама эта задача обучения разбивается на несколько подстадий.  

  
## problem
  
Одна из самых творческих задач – это умение переформулировать задачу на язык машинного обучения. В примере, который рассматривали ранее, система сама подсказывала возможные методы решения.  

Как нам понять расстанется ли игрок с нами или продолжит пользоваться нашим приложением? Т.е. задача намекает на то, что возможно это задача классификации и возможно классом является тот факт, что человек играет или не играет. Это подсказывает нам как организовать подготовку данных, как разметить нашу выборку и какой метод машинного обучения использовать.  

Однако, это далеко не всегда так. Как научить компьютер играть в шахматы? Эта задача в своём первозданном виде никак не помогает нам понять какой метод машинного обучения и как использовать; какие данные нам нужны и вообще с чего начинать.   

Или как научить программу общаться с другим человеком так, как будто она другой настоящий человек.  

Что думает сама программа по этому поводу?
- Алиса, как ты работаешь?
- Сделать меня довольно просто: возьмите подающую надежду нейросеть, научите её распознавать человеческую речь и отвечать на вопросы. Чувство юмора и сарказм - по вкусу.
- Понятно, спасибо.  

Даже Алиса говорит о том, что без нейронных сетей здесь не обошлось. Но чувствуется разрыв между исходной задачей и её реализацией.   

Какие данные нужно собрать? Как их подготовить? Как переформулировать задачу на понятный для машинного обучения язык?  

И мы попробуем с этим поработать в рамках курса.  

  
## data preparation
  
Следующая стадия в обучении любой модели – подготовка данных. Это огромная, очень важная тема, связанная с чисткой данных с feature engineering (извлечение из данных тех показателей, которые мы хотим использовать для обучения модели). Например, в случае линейной регрессии, скажем это извлечение из данных зависимых переменных, для того чтобы предсказать независимую. Это зачастую не так-то просто как кажется, и это очень важная часть машинного обучения, и об этом мы также поговорим.  

Рассмотрим пример: данные поведения игроков из воображаемой игры могли бы быть сохранены в таком виде:
  
|user_id|user_name|event|platform|time|
|---------|-------------|------|-----------|-----|
| 1 | Boromir | start_game | android | 1550690622 |
| 1 | Boromir | purchase_sword | android | 1550690623 |
| 1 | Boromir | kill_goblin | android | 1550690624 |
| 1 | Boromir | kill_goblin | android | 1550690625 |
| 1 | Boromir | kill_goblin | android | 1550690626 |
| 1 | Boromir | kill_goblin | android | 1550690627 |
| 1 | Boromir | killed_by_goblin | android | 1550690628 |
  
Где мы для каждого игрока пишем время, событие и какой-то идентификатор, чтобы понять - события какого игрока мы наблюдаем.  

Понятное дело, что данные в таком виде хранятся, мы их так записываем, они так хранятся в csv-файле, который дал нам data-engineer и сказал: «Вот применяй модель машинного обучения». Однако, данные не позволяют нам ничего сделать.  

Нужно их переструктурировать, переформировать, извлечь из них нужные признаки, разметить нашу выборку и т.д. Зачастую это важный процесс, позволяющий нам понять, что пользователь ушёл или не ушёл, и как вообще это определить? Игрок не заходил месяц, или два? Мы подумаем какие feature можно придумать – сколько гоблинов убил пользователь или сколько игр сыграл, ни разу не проиграв.  

Всё это преобразует наш исходный dataframe в новый, где в качестве колонок будут признаки объекта, которые мы хотим использовать для обучения нашей модели, а в какой-то ещё колонке (часто её называют y) будет некоторый класс – например 1 или 0, в том смысле ушёл человек из игры или нет. Мы позже обсудим это подробнее.  

  
## machine learning
  
После того, как мы взяли сырые данные и как-то их переформулировали, переструктурировали, агрегировали и подготовили их, чтобы можно было применить машинное обучение наступает этап применения машинного обучения.  

В большинстве случаев это код, написанный на python или другом языке программирования, который использует разные методы машинного обучения (например, регрессию, нейросеть, дерево решений) и обучает нашу модель. Мы ещё подробнее поговорим о том, что значит обучить модель.
  

## validation
  
После того, как мы применили модель машинного обучения – сажем, сформировали регрессию, подобрали коэффициенты и сможем теперь предсказывать наш класс – 0 или 1 происходит очень важный этап – валидация модели.  

Мы хотим убедиться, что наша модель может выше случайного предсказывать нашу исходную переменную. Она действительно работает и как в этом убедиться и какие могут быть проблемы с тем, когда это не так. И как вообще понять, что есть проблема.  

В курсе по статистики мы не занимались какой-либо валидацией. Мы реализовывали метод и выполняли его, никак не валидируя себя. А в методах машинного обучения это отдельная важная стадия как именно убедиться в том, что наша модель может переносить полученные знания с одних данных на некоторые другие данные, которые она раньше не видела.  

  
## Резюме
  
Всё вместе это – машинное обучение.  

В нашем курсе больший акцент на обучение модели, в меньшей степени на извлечение и обработку данных.  

Столкнувшись на практике с реальным проектом, вы поймете, что на самом деле никаких данных нет. Их нужно откуда-то собрать, откуда-то придумать, сконструировать набор признаков, по которым вы будете обучаться. В курсе же в основном будет говориться о том, как модели работают и как они обучаются.   

Машинное обучение всегда интегрировано в более сложную структуру data science и всегда нужно помнить о стадиях, которые лежат до и после.  

Используйте ссылки на дополнительные материалы, чтобы выстроить у себя более чёткую картину происходящего.  
